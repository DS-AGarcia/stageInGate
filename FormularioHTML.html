<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
      @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Roboto:wght@400;500&display=swap');

      body {
          font-family: 'Roboto', Arial, sans-serif;
          margin: 0;
          padding: 40px 0; /* espaço no topo */
          min-height: 100vh;
          background: url("https://i.imgur.com/o250YBX.jpeg") no-repeat center center fixed; /* Substitua pelo link direto da sua imagem */
          background-size: cover;
          display: flex;
          justify-content: center; /* Centraliza horizontalmente */
          align-items: flex-start; /* Mantém no topo */
          color: #333;
      }

      h1, h2, h3 {
          font-family: 'Montserrat', Arial, sans-serif;
          color: #d60000; /* Vermelho corporativo */
          margin-bottom: 10px;
      }

      .form-container {
          background: rgba(255, 255, 255, 0.95); /* branco quase opaco */
          padding: 25px;
          border-radius: 8px;
          box-shadow: 0 4px 10px rgba(0,0,0,0.2);
          max-width: 700px;
          width: 100%;
      }

      label {
          font-weight: 500;
          margin-bottom: 5px;
          display: block;
      }

      input, select, textarea {
          width: 100%;
          padding: 10px;
          border-radius: 4px;
          border: 1px solid #ccc;
          font-size: 14px;
          box-sizing: border-box;
          margin-bottom: 15px;
      }

      button {
          background-color: #d60000;
          color: #fff;
          border: none;
          padding: 10px 20px;
          cursor: pointer;
          border-radius: 4px;
          font-weight: bold;
          transition: background-color 0.3s;
      }

      button:hover {
          background-color: #a30000;
      }
  </style>
</head>
<body>
  <div id="main-form-container" class="form-container">
    <h1>Formulário Stage in Gate</h1>

    <div id="secao1">
      <h2>1. Identificação</h2>
      <div class="form-group"><label for="colaboradorDS">Colaborador DS:</label><input type="text" id="colaboradorDS" name="colaboradorDS" required></div>
      <div class="form-group"><label for="solicitante">Solicitante:</label><input type="text" id="solicitante" name="solicitante" required></div>
      <div class="form-group"><label for="partNumber">Part Number:</label><input type="text" id="partNumber" name="partNumber"></div>
      <div class="form-group"><label for="imagem">Imagem do Produto:</label><input type="file" id="imagem" name="imagem" accept="image/*"></div>
      <div class="form-group">
        <label for="tipoProjeto">Tipo de Projeto:</label>
        <select id="tipoProjeto" name="tipoProjeto" required>
          <option value="">Selecione...</option>
          <option value="Complemento de Linha">Complemento de Linha</option>
          //<option value="Linha Nova (INATIVO)">Linha Nova</option>
        </select>
      </div>
    </div>

    <button id="btnIniciar">Iniciar</button>
    <div id="secaoTipoProjeto"></div>
  </div>

  <script>
    function carregarFormulario() {
      const tipo = document.getElementById("tipoProjeto").value;
      if (!tipo) {
        alert("Por favor, selecione o tipo de projeto.");
        return;
      }
      const btnIniciar = document.getElementById('btnIniciar');
      btnIniciar.disabled = true;
      btnIniciar.style.display = 'none';

      const container = document.getElementById("secaoTipoProjeto");
      container.innerHTML = "<p>Carregando...</p>";

      google.script.run.withSuccessHandler(function(html) {
        container.innerHTML = html;
        Array.from(container.querySelectorAll("script")).forEach(oldScript => {
          const newScript = document.createElement("script");
          Array.from(oldScript.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value));
          newScript.appendChild(document.createTextNode(oldScript.innerHTML));
          oldScript.parentNode.replaceChild(newScript, oldScript);
        });
      }).getFormHTML(tipo);
    }
    document.getElementById('btnIniciar').addEventListener('click', carregarFormulario);
  </script>
</body>
</html>